## テストとは

プログラムを行う際、最初はどんどんと書けていっても段々と一つコードに変更を行うと、他の部分にも影響が出てしまう。あるいは、既に書かれたコードをパフォーマンス改善や可読性の向上のために書き直したい。というようなことが出てきます。こんな時に、書き直したコードがちゃんと機能するかチェックしたい、また他の影響が出そうな部分もちゃんと今まで通り動くかチェックしたい。と考えるはずです。しかし、これを全て手動でチェックしようとするとプログラムを変更する度にそれを行う必要があり、面倒な上、チェックをし忘れたり、ブラウザを開くのに時間がかかったりして非効率です。こうした非効率性を下げるために、プログラマはテストを書きます。

## テストフレームワーク

Javascriptでは、テストを行うためのフレームワークは非常に多くあります。現在最も人気があるのはMochaというものです。またJasmineというフレームワークも非常に人気があります。CodeGritではReactでのテストフレームワークとして標準になっており、現在サーバーサイドJavascriptのテストフレームワークとしても人気が高まっているJestを学びます。

## Jestフレームワークとは

Jestは元々FacebookがReactのテストをより効率的に行うためにJasmineをベースに作成したテストフレームワークです。Jestの最大のメリットはReactのテストが行いやすいという点です。また、初期設定が簡単というメリットもあります。Mochaを使いたいという場合、React側はJestでテストし、サーバー側はMochaでテストするという風になりスイッチングコストが発生します。そのため、最初の段階ではJestを使って全てをテストして、テストコードを書くこと自体に慣れるのが良いでしょう。

## Jestを設定する

Jestを利用するには、NPMパッケージからJestをインストールする必要があります。まずはjest-testというフォルダを作成して、`yarn init`でpackage.jsonを作成しましょう。

```bash
$ mkdir jest-test
$ cd jest-test
$ yarn init -y
$ yarn add -D jest babel-jest
```

**完成コードはこちら:** [サンプルコード](https://github.com/codegrit-jp-students/js-unit02-lesson09-sample01)

上記でbabel-jestはES6のコードをES5にトランスパイルするために利用します。

次に、`package.json`を編集し、NPMスクリプトからテストを呼び出せるようにします。また同時にトランスパイルが全ての.js拡張子を持つファイルについて行われるよう設定します。

```json
/* package.json */

{
  ...
  "scripts": {
    "test": "jest --watchAll"
  },
  "jest": {
    "transform": {
      "^.+\\.jsx?$": "babel-jest"
    }
  },
  "devDependencies": {...}
}
```

最後に、トランスパイルがきちんと行われるようにbabel-preset-envというプラグインをダウンロードし、babelの設定ファイルを編集します。babelの設定ファイルは`.babelrc`という名前でプロジェクトのルートディレクトリに作成します。

- babel-preset-envのインストール

```bash
$ yarn add -D babel-preset-env
```

- .babelrcの作成。

```
{
  "presets": ["env"]
}
```

以上で準備が完了しました。試しにtestを動かしてみましょう。

```bash
$ yarn test
No tests found
...
```

上記のように"No tests found"と表示されたら成功です。